webpackJsonp([5],{"4ept":function(e,t){},K9F0:function(e,t){},N2vk:function(e,t){},ge9x:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Neex"),n=a("Xxa5"),o=a.n(n),l=a("exGp"),u=a.n(l),s=a("RwfU"),c=a("mtWM"),i=a.n(c),m=a("BO1k"),f=a.n(m),v=a("mvHQ"),d=a.n(v),p=a("g7ZD"),b=a("Er6Z"),_=a("So6Q"),h={name:"editMenuForm",created:function(){var e=this;this.getFormSelect(),this.getMenuSelect(),p.a.$on("showEditMenuForm",function(t){e.form=JSON.parse(d()(t)),e.old=JSON.parse(d()(t)),e.dialogVisible=!0})},data:function(){var e=this;return{old:{},form:{menu_id:-1,menu_name:"",menu_level:"",father_menu:"",context_form:""},dialogVisible:!1,options:[{label:"一级菜单",value:"一级菜单"},{label:"二级菜单",value:"二级菜单"}],menuList:[],formList:[],menuRule:{menu_name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],menu_level:[{required:!0,message:"请选择菜单级别",trigger:"blur"}],father_menu:[{validator:function(t,a,r){return""!==a&&"一级菜单"===e.form.menu_level?r(new Error("一级菜单没有父菜单")):""===a&&"二级菜单"===e.form.menu_level?r(new Error("请选择父菜单")):void r()},trigger:"blur"}],context_form:[{validator:function(t,a,r){return""!==a&&"一级菜单"===e.form.menu_level?r(new Error("一级菜单没有关联表单")):""===a&&"二级菜单"===e.form.menu_level?r(new Error("请选择关联表单")):void r()},trigger:"blur"}]}}},methods:{getMenuSelect:function(){var e=this;return u()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/api/menu/select");case 3:200!==(a=t.sent).data.code?Object(b.a)(a.data):e.menuList=a.data.data.reverse(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object(s.a)(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},getFormSelect:function(){var e=this;return u()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/api/menu/form");case 3:200!==(a=t.sent).data.code?Object(b.a)(a.data):e.formList=a.data.data.reverse(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object(s.a)(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},closeEvent:function(){this.dialogVisible=!1,this.$refs.form.resetFields()},save:function(){var e=this;return u()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate(function(){var t=u()(o.a.mark(function t(a){var r,n,l,u,c,m,v,d;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:for(t.prev=2,r=Object(_.a)(e.old,e.form),n=!0,l=!1,u=void 0,t.prev=7,c=f()(r);!(n=(m=c.next()).done);n=!0)"father_menu"===(v=m.value).col_name&&""===v.value&&(v.value=0),"context_form"===v.col_name&&""===v.value&&(v.value=0);t.next=15;break;case 11:t.prev=11,t.t0=t.catch(7),l=!0,u=t.t0;case 15:t.prev=15,t.prev=16,!n&&c.return&&c.return();case 18:if(t.prev=18,!l){t.next=21;break}throw u;case 21:return t.finish(18);case 22:return t.finish(15);case 23:return console.log(r),t.next=26,i.a.post("/api/menu/edit",{menu_id:e.form.menu_id,update:r});case 26:200!==(d=t.sent).data.code?Object(b.a)(d.data):(e.closeEvent(),p.a.$emit("refreshMenu"),e.$message.success("修改表单成功")),t.next=33;break;case 30:t.prev=30,t.t1=t.catch(2),Object(s.a)(t.t1.message);case 33:case"end":return t.stop()}},t,e,[[2,30],[7,11,15,23],[16,,18,22]])}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}},t,e)}))()}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.dialogVisible,"before-close":e.closeEvent},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",staticStyle:{width:"50%",margin:"auto"},attrs:{model:e.form,rules:e.menuRule,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"菜单名称",prop:"menu_name"}},[a("el-input",{attrs:{placeholder:"请输入菜单名称"},model:{value:e.form.menu_name,callback:function(t){e.$set(e.form,"menu_name",t)},expression:"form.menu_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"菜单级别",prop:"menu_level"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.menu_level,callback:function(t){e.$set(e.form,"menu_level",t)},expression:"form.menu_level"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"父菜单",prop:"father_menu"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:"一级菜单"===e.form.menu_level,clearable:""},model:{value:e.form.father_menu,callback:function(t){e.$set(e.form,"father_menu",t)},expression:"form.father_menu"}},e._l(e.menuList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"关联表单",prop:"context_form"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:"一级菜单"===e.form.menu_level,clearable:""},model:{value:e.form.context_form,callback:function(t){e.$set(e.form,"context_form",t)},expression:"form.context_form"}},e._l(e.formList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})}),1)],1)],1),e._v(" "),a("span",{staticStyle:{margin:"auto"}},[a("el-button",{on:{click:e.closeEvent}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var x=a("VU/8")(h,g,!1,function(e){a("4ept")},"data-v-fc6cf2b8",null).exports,k={name:"addMenuForm",created:function(){var e=this;this.getFormSelect(),this.getMenuSelect(),p.a.$on("showAddMenuForm",function(){e.dialogVisible=!0})},data:function(){var e=this;return{form:{menu_id:-1,menu_name:"",menu_level:"",father_menu:"",context_form:""},dialogVisible:!1,options:[{label:"一级菜单",value:"一级菜单"},{label:"二级菜单",value:"二级菜单"}],menuList:[],formList:[],menuRule:{menu_name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],menu_level:[{required:!0,message:"请选择菜单级别",trigger:"blur"}],father_menu:[{validator:function(t,a,r){return""!==a&&"一级菜单"===e.form.menu_level?r(new Error("一级菜单没有父菜单")):""===a&&"二级菜单"===e.form.menu_level?r(new Error("请选择父菜单")):void r()},trigger:"blur"}],context_form:[{validator:function(t,a,r){return""!==a&&"一级菜单"===e.form.menu_level?r(new Error("一级菜单没有关联表单")):""===a&&"二级菜单"===e.form.menu_level?r(new Error("请选择关联表单")):void r()},trigger:"blur"}]}}},methods:{getMenuSelect:function(){var e=this;return u()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("api/menu/select");case 3:200!==(a=t.sent).data.code?Object(b.a)(a.data):e.menuList=a.data.data,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object(s.a)(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},getFormSelect:function(){var e=this;return u()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/api/menu/form");case 3:200!==(a=t.sent).data.code?Object(b.a)(a.data):e.formList=a.data.data,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object(s.a)(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},closeEvent:function(){this.dialogVisible=!1,this.$refs.form.resetFields()},save:function(){var e=this;return u()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate(function(){var t=u()(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,i.a.post("/api/menu/add",e.form);case 5:200!==(r=t.sent).data.code?Object(b.a)(r.data):(p.a.$emit("refreshMenu"),e.closeEvent()),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),Object(s.a)(t.t0.message);case 12:case"end":return t.stop()}},t,e,[[2,9]])}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}},t,e)}))()}}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.dialogVisible,"before-close":e.closeEvent},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",staticStyle:{width:"50%",margin:"auto"},attrs:{model:e.form,rules:e.menuRule,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"菜单名称",prop:"menu_name"}},[a("el-input",{attrs:{placeholder:"请输入菜单名称"},model:{value:e.form.menu_name,callback:function(t){e.$set(e.form,"menu_name",t)},expression:"form.menu_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"菜单级别",prop:"menu_level"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.menu_level,callback:function(t){e.$set(e.form,"menu_level",t)},expression:"form.menu_level"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"父菜单",prop:"father_menu"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:"一级菜单"===e.form.menu_level},model:{value:e.form.father_menu,callback:function(t){e.$set(e.form,"father_menu",t)},expression:"form.father_menu"}},e._l(e.menuList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"关联表单",prop:"context_form"}},[a("el-select",{attrs:{placeholder:"请选择管理表单",disabled:"一级菜单"===e.form.menu_level},model:{value:e.form.context_form,callback:function(t){e.$set(e.form,"context_form",t)},expression:"form.context_form"}},e._l(e.formList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})}),1)],1)],1),e._v(" "),a("span",{staticStyle:{margin:"auto"}},[a("el-button",{on:{click:e.closeEvent}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var $={name:"menuList",components:{AddMenuForm:a("VU/8")(k,w,!1,function(e){a("zmDM")},"data-v-7234fa1d",null).exports,EditMenuForm:x},data:function(){return{toolBarConfig:{slots:{buttons:"toolbar_buttons"}},form_name:"",form_id:-1,searchName:"",tablePage:{currentPage:1,pageSize:10},tableColumn:[{field:"menu_name",title:"菜单名称"},{field:"menu_level",title:"菜单级别"},{field:"father_menu",title:"父菜单"},{field:"context_form",title:"关联表单"}],tableData:[]}},created:function(){var e=this;this.query(""),p.a.$on("refreshMenu",function(){e.query("")})},methods:{query:function(e){var t=this;return u()(o.a.mark(function a(){var r;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$http.get("/api/menu/query",{params:{menu_name:e}});case 3:200!==(r=a.sent).data.code?Object(b.a)(r.data.msg):t.tableData=r.data.data,a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),Object(s.a)(a.t0);case 10:case"end":return a.stop()}},a,t,[[0,7]])}))()},addEvent:function(){p.a.$emit("showAddMenuForm")},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.tablePage.currentPage=t,this.tablePage.pageSize=a},removeEvent:function(){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(u()(o.a.mark(function t(){var a,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.$refs.menuTable.getCurrentRecord(),t.next=4,i.a.post("api/menu/delete",{menu_id:a.menu_id});case 4:200!==(r=t.sent).data.code?Object(b.a)(r.data):e.tableData=r.data.data,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),Object(s.a)(t.t0.message);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))).catch(function(){e.$message({type:"info",message:"已取消删除"})})},editEvent:function(){var e=this.$refs.menuTable.getCurrentRecord();if(!e)return Object(s.a)("请先选择需要修改的数据");p.a.$emit("showEditMenuForm",e)}}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("vxe-grid",{ref:"menuTable",attrs:{border:"",resizable:"","toolbar-config":e.toolBarConfig,"row-config":{isCurrent:!0},columns:e.tableColumn,data:e.tableData},scopedSlots:e._u([{key:"toolbar_buttons",fn:function(){return[a("vxe-input",{attrs:{placeholder:"请输入菜单名称",clearable:""},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}}),e._v(" "),a("vxe-button",{attrs:{status:"primary"},on:{click:function(t){return e.query(e.searchName)}}},[e._v("搜索")]),e._v(" "),a("vxe-button",{attrs:{status:"success"},on:{click:e.addEvent}},[e._v("新增")]),e._v(" "),a("vxe-button",{attrs:{status:"success"},on:{click:e.editEvent}},[e._v("修改")]),e._v(" "),a("vxe-button",{attrs:{status:"success"},on:{click:e.removeEvent}},[e._v("删除")]),e._v(" "),a("vxe-button",{on:{click:function(t){return e.$refs.menuTable.exportData()}}},[e._v("导出")])]},proxy:!0},{key:"pager",fn:function(){return[a("vxe-pager",{attrs:{layouts:["Sizes","PrevJump","PrevPage","Number","NextPage","NextJump","FullJump","Total"],"current-page":e.tablePage.currentPage,"page-size":e.tablePage.pageSize,total:e.tableData.length},on:{"update:currentPage":function(t){return e.$set(e.tablePage,"currentPage",t)},"update:current-page":function(t){return e.$set(e.tablePage,"currentPage",t)},"update:pageSize":function(t){return e.$set(e.tablePage,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tablePage,"pageSize",t)},"page-change":e.handlePageChange}})]},proxy:!0}])}),e._v(" "),a("add-menu-form"),e._v(" "),a("edit-menu-form")],1)},staticRenderFns:[]};var E={name:"menuPage",components:{MenuList:a("VU/8")($,y,!1,function(e){a("N2vk")},"data-v-6a930381",null).exports,PageHead:r.a}},P={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("page-head",{staticClass:"nav"}),this._v(" "),t("el-container",[t("el-card",[t("menu-list",{staticStyle:{width:"80%",margin:"auto"}})],1)],1)],1)},staticRenderFns:[]};var S=a("VU/8")(E,P,!1,function(e){a("K9F0")},"data-v-1b31837e",null);t.default=S.exports},zmDM:function(e,t){}});
//# sourceMappingURL=5.c58056aa080d51280f9b.js.map