webpackJsonp([18],{"2lBJ":function(e,t){},"D/nI":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("woOf"),n=a.n(r),c=a("BO1k"),s=a.n(c),o=a("fZjL"),i=a.n(o),u=a("mvHQ"),l=a.n(u),f=a("Xxa5"),p=a.n(f),d=a("exGp"),v=a.n(d),b=a("Er6Z"),m=a("RwfU"),h={name:"recycle",data:function(){return{form_id:"",len:3,showMore:!1,formList:[],toolBarConfig:{slots:{buttons:"toolbar_buttons"}},is_add:!0,tablePage:{currentPage:1,pageSize:10},tableColumn:[],tableData:[],copyData:[],currentData:[],queryForm:{}}},created:function(){this.getFormList()},watch:{form_id:function(e){e&&this.getTableColumn(e)}},methods:{getFormList:function(){var e=this;return v()(p.a.mark(function t(){var a;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.get("/api/menu/form");case 3:200!==(a=t.sent).data.code?Object(b.a)(a.data):e.formList=a.data.data,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object(m.a)(t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},showMoreFunc:function(){this.showMore=!this.showMore,this.showMore?this.len=this.tableColumn.length:this.len=3},getTableColumn:function(e){var t=this;return v()(p.a.mark(function a(){var r;return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(-1!==e&&void 0!==e){a.next=2;break}return a.abrupt("return");case 2:return a.prev=2,a.next=5,t.$http.get("api/data/column",{params:{form_id:e}});case 5:if(200===(r=a.sent).data.code){a.next=10;break}Object(b.a)(r.data),a.next=14;break;case 10:return t.tableColumn=r.data.data,t.tableColumn.push({field:"file",title:"附件",value:""}),a.next=14,t.queryRecycleData(e);case 14:a.next=19;break;case 16:a.prev=16,a.t0=a.catch(2),Object(m.a)(a.t0.message);case 19:case"end":return a.stop()}},a,t,[[2,16]])}))()},queryRecycleData:function(e){var t=this;return v()(p.a.mark(function a(){var r;return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$http.post("api/recycle/query",{form_id:e,columns:t.getQueryList()});case 3:200!==(r=a.sent).data.code?Object(b.a)(r.data):(t.copyData=r.data.data,t.tableData=t.formatData(JSON.parse(l()(r.data.data))),console.log(t.tableData),t.page()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),Object(m.a)(a.t0.message);case 10:case"end":return a.stop()}},a,t,[[0,7]])}))()},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.tablePage.currentPage=t,this.tablePage.pageSize=a,this.currentData=this.tableData.slice((t-1)*a,a*t)},page:function(){var e=this.tablePage.pageSize;this.currentData=this.tableData.slice(0,e)},getQueryList:function(){var e=[],t=i()(this.queryForm),a=!0,r=!1,n=void 0;try{for(var c,o=s()(t);!(a=(c=o.next()).done);a=!0){var u=c.value;""!==this.queryForm[u]&&null!==this.queryForm[u]&&void 0!==this.queryForm[u]&&e.push({col_name:u,value:this.queryForm[u]})}}catch(e){r=!0,n=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw n}}return e},resetForm:function(){this.$refs.queryForm.resetFields(),this.$message.success("查询表单已重置")},recover:function(){var e=this;return v()(p.a.mark(function t(){var a,r,n;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=e.$refs.recycleTable.getCurrentRecord()){t.next=4;break}return t.abrupt("return",Object(m.a)("请选择要恢复的数据"));case 4:return r=e.copyData.filter(function(e){return e.del_id===a.del_id})[0],console.log(r),t.next=8,e.$http.post("api/recycle/restore",{form_id:e.form_id,del_id:r.del_id,data:r.data});case 8:if(200===(n=t.sent).data.code){t.next=13;break}Object(b.a)(n.data),t.next=15;break;case 13:return t.next=15,e.queryRecycleData(e.form_id);case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),Object(m.a)(t.t0.message);case 20:case"end":return t.stop()}},t,e,[[0,17]])}))()},recoverAll:function(){var e=this;return v()(p.a.mark(function t(){var a;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("api/recycle/restore/all",{},{params:{form_id:e.form_id}});case 3:if(200===(a=t.sent).data.code){t.next=8;break}Object(b.a)(a.data),t.next=10;break;case 8:return t.next=10,e.queryRecycleData(e.form_id);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),Object(m.a)(t.t0.message);case 15:case"end":return t.stop()}},t,e,[[0,12]])}))()},clear:function(){var e=this;this.$confirm("此操作会彻底删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(v()(p.a.mark(function t(){var a,r;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=e.$refs.recycleTable.getCurrentRecord()){t.next=4;break}return t.abrupt("return",Object(m.a)("请选择要删除的记录"));case 4:return t.next=6,e.$http.post("api/recycle/delete",{},{params:{id:a.del_id}});case 6:if(200===(r=t.sent).data.code){t.next=11;break}Object(b.a)(r.data),t.next=13;break;case 11:return t.next=13,e.queryRecycleData(e.form_id);case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),Object(m.a)(t.t0.message);case 18:case"end":return t.stop()}},t,e,[[0,15]])})))},clearAll:function(){var e=this;this.$confirm("此操作会彻底删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(v()(p.a.mark(function t(){var a;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("api/recycle/clear",{},{params:{form_id:e.form_id}});case 3:if(200===(a=t.sent).data.code){t.next=8;break}Object(b.a)(a.data),t.next=10;break;case 8:return t.next=10,e.queryRecycleData(e.form_id);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),Object(m.a)(t.t0.message);case 15:case"end":return t.stop()}},t,e,[[0,12]])})))},formatData:function(e){var t=[],a=!0,r=!1,c=void 0;try{for(var o,i=s()(e);!(a=(o=i.next()).done);a=!0){var u=o.value,f=JSON.parse(l()(u.data));delete u.data,t.push(n()(u,f))}}catch(e){r=!0,c=e}finally{try{!a&&i.return&&i.return()}finally{if(r)throw c}}return t}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-body"},[a("el-row",[a("el-form",{ref:"queryForm",attrs:{model:e.queryForm,"label-width":"80px",size:"small"}},e._l(e.tableColumn.slice(0,e.len),function(t,r){return a("el-col",{key:r,attrs:{span:8}},[a("el-form-item",{attrs:{prop:t.field,label:t.title}},[a("el-input",{attrs:{clearable:""},model:{value:e.queryForm[t.field],callback:function(a){e.$set(e.queryForm,t.field,a)},expression:"queryForm[item.field]"}})],1)],1)}),1)],1),e._v(" "),a("vxe-grid",{ref:"recycleTable",staticClass:"dataList",attrs:{border:"",resizable:"","toolbar-config":e.toolBarConfig,"row-config":{isCurrent:!0},columns:e.tableColumn,data:e.currentData},scopedSlots:e._u([{key:"toolbar_buttons",fn:function(){return[a("div",{staticStyle:{"text-align":"right"}},[a("vxe-select",{attrs:{clearable:"",transfer:"",placeholder:"请选择要查看的表单"},model:{value:e.form_id,callback:function(t){e.form_id=t},expression:"form_id"}},e._l(e.formList,function(e){return a("vxe-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1),e._v(" "),a("span",{staticStyle:{"margin-right":"20px"}},[a("vxe-button",{attrs:{status:"primary"},on:{click:function(t){return e.queryRecycleData(e.form_id)}}},[e._v("查询")]),e._v(" "),a("vxe-button",{on:{click:e.resetForm}},[e._v("重置")]),e._v(" "),e.showMore?a("el-button",{attrs:{type:"text"},on:{click:e.showMoreFunc}},[a("i",{staticClass:"el-icon-arrow-up"}),e._v("收起")]):a("el-button",{attrs:{type:"text"},on:{click:e.showMoreFunc}},[a("i",{staticClass:"el-icon-arrow-down"}),e._v("展开")])],1),e._v(" "),a("vxe-button",{attrs:{status:"success"},on:{click:e.clear}},[e._v("彻底删除")]),e._v(" "),a("vxe-button",{attrs:{status:"success"},on:{click:e.clearAll}},[e._v("全部清空")]),e._v(" "),a("vxe-button",{attrs:{status:"success"},on:{click:e.recover}},[e._v("恢复数据")]),e._v(" "),a("vxe-button",{attrs:{status:"success"},on:{click:e.recoverAll}},[e._v("全部恢复")])],1)]},proxy:!0},{key:"pager",fn:function(){return[a("vxe-pager",{attrs:{layouts:["Sizes","PrevJump","PrevPage","Number","NextPage","NextJump","FullJump","Total"],"current-page":e.tablePage.currentPage,"page-size":e.tablePage.pageSize,total:e.tableData.length},on:{"update:currentPage":function(t){return e.$set(e.tablePage,"currentPage",t)},"update:current-page":function(t){return e.$set(e.tablePage,"currentPage",t)},"update:pageSize":function(t){return e.$set(e.tablePage,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tablePage,"pageSize",t)},"page-change":e.handlePageChange}})]},proxy:!0}])})],1)},staticRenderFns:[]};var x=a("VU/8")(h,g,!1,function(e){a("2lBJ")},"data-v-7c3558a4",null);t.default=x.exports}});
//# sourceMappingURL=18.26273f111d2cbef70dbf.js.map