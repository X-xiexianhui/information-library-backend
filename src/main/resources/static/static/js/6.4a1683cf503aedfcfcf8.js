webpackJsonp([6],{"0qjh":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),s=r.n(a),n=r("exGp"),i=r.n(n),o=r("RwfU"),u=r("mtWM"),l=r.n(u),c=r("mvHQ"),d=r.n(c),m=r("g7ZD"),f=r("So6Q"),p=r("Er6Z"),v={name:"userEditForm",props:{user_data:{type:Object,default:function(){return{user_id:"",user_name:"",user_email:"",user_role:""}}}},data:function(){return{form:JSON.parse(d()(this.user_data)),dialogVisible:!1,formRule:{user_id:[{required:!0,message:"请输入用户账号",trigger:"blur"},{min:4,max:18,message:"请输入4-18位账号"}],user_name:[{required:!0,message:"请输入用户名称",trigger:"blur"}],user_email:[{required:!0,message:"请输入用户邮箱",trigger:"blur"},{pattern:/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/,message:"邮箱格式错误",trigger:"blur"}],user_role:[{required:!0,message:"请选择用户角色",trigger:"blur"}]},roleList:[]}},created:function(){var e=this;this.getRoleList(),m.a.$on("showEditUserForm",function(){e.dialogVisible=!0})},watch:{user_data:function(e){this.form=JSON.parse(d()(e))}},methods:{closeEvent:function(){this.dialogVisible=!1,this.$refs.form.resetFields()},getRoleList:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.a.get("/api/role/select");case 3:200!==(r=t.sent).data.code?Object(p.a)(r.data):e.roleList=r.data.data.reverse(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object(o.a)(t.t0.message);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},save:function(){var e,t=this;this.$refs.form.validate((e=i()(s.a.mark(function e(r){var a,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,a=Object(f.a)(t.user_data,t.form),e.next=6,l.a.post("/api/user/edit",{user_id:t.user_data.user_id,update:a});case 6:200!==(n=e.sent).data.code?Object(p.a)(n.data):(m.a.$emit("refreshUser"),t.closeEvent()),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),Object(o.a)(e.t0.message);case 13:case"end":return e.stop()}},e,t,[[2,10]])})),function(t){return e.apply(this,arguments)}))}}},b={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{visible:e.dialogVisible,"before-close":e.closeEvent},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",staticStyle:{margin:"auto",width:"60%"},attrs:{model:e.form,rules:e.formRule,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"用户账号",prop:"user_id"}},[r("div",{staticStyle:{"text-align":"left"}},[e._v(e._s(e.form.user_id))])]),e._v(" "),r("el-form-item",{attrs:{label:"用户名称",prop:"user_name"}},[r("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.form.user_name,callback:function(t){e.$set(e.form,"user_name",t)},expression:"form.user_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户邮箱",prop:"user_email"}},[r("el-input",{attrs:{placeholder:"请输入用户邮箱"},model:{value:e.form.user_email,callback:function(t){e.$set(e.form,"user_email",t)},expression:"form.user_email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户角色",prop:"user_role"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.user_role,callback:function(t){e.$set(e.form,"user_role",t)},expression:"form.user_role"}},e._l(e.roleList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),r("span",{staticStyle:{margin:"auto"}},[r("el-button",{on:{click:e.closeEvent}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var g=r("VU/8")(v,b,!1,function(e){r("sUJ6")},"data-v-1376d2e0",null).exports,_={name:"userAddForm",data:function(){return{form:{user_id:"",user_name:"",user_email:"",user_role:""},roleList:[],dialogVisible:!1,formRule:{user_id:[{required:!0,message:"请输入用户账号",trigger:"blur",length:4}],user_name:[{required:!0,message:"请输入用户名称",trigger:"blur"}],user_email:[{required:!0,message:"请输入用户邮箱",trigger:"blur"},{pattern:/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/,message:"邮箱格式错误",trigger:"blur"}],user_role:[{required:!0,message:"请选择用户角色",trigger:"blur"}]}}},created:function(){var e=this;this.getRoleList(),m.a.$on("showAddUserForm",function(){e.dialogVisible=!0})},methods:{closeEvent:function(){this.dialogVisible=!1,this.$refs.authForm.resetFields()},getRoleList:function(){var e=this;return i()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.a.get("/api/role/select");case 3:200!==(r=t.sent).data.code?Object(p.a)(r.data):e.roleList=r.data.data.reverse(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object(o.a)(t.t0.message);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},save:function(){var e=this;return i()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.authForm.validate(function(){var t=i()(s.a.mark(function t(r){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,l.a.post("/api/user/add",e.form);case 5:200!==(a=t.sent).data.code?Object(p.a)(a.data):(m.a.$emit("refreshUser"),e.closeEvent()),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),Object(o.a)(t.t0.message);case 12:case"end":return t.stop()}},t,e,[[2,9]])}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}},t,e)}))()}}},h={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.dialogVisible,"before-close":e.closeEvent},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"authForm",staticStyle:{margin:"auto",width:"60%"},attrs:{model:e.form,rules:e.formRule,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"用户账号",prop:"user_id"}},[r("el-input",{attrs:{placeholder:"请输入用户账号"},model:{value:e.form.user_id,callback:function(t){e.$set(e.form,"user_id",t)},expression:"form.user_id"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户名称",prop:"user_name"}},[r("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.form.user_name,callback:function(t){e.$set(e.form,"user_name",t)},expression:"form.user_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户邮箱",prop:"user_email"}},[r("el-input",{attrs:{placeholder:"请输入用户邮箱"},model:{value:e.form.user_email,callback:function(t){e.$set(e.form,"user_email",t)},expression:"form.user_email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"用户角色",prop:"user_role"}},[r("el-select",{staticStyle:{"text-align":"left"},attrs:{placeholder:"请选择"},model:{value:e.form.user_role,callback:function(t){e.$set(e.form,"user_role",t)},expression:"form.user_role"}},e._l(e.roleList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.label}})}),1)],1)],1),e._v(" "),r("span",{staticStyle:{margin:"auto"}},[r("el-button",{on:{click:e.closeEvent}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var x={name:"userList",components:{UserAddForm:r("VU/8")(_,h,!1,function(e){r("n3GN")},"data-v-102a6006",null).exports,UserEditForm:g},data:function(){return{toolBarConfig:{slots:{buttons:"toolbar_buttons"}},user_data:{},searchName:"",tablePage:{currentPage:1,pageSize:10},tableColumn:[{field:"user_id",title:"用户账号"},{field:"user_name",title:"用户名称"},{field:"user_email",title:"用户邮箱"},{field:"user_role",title:"用户角色"}],tableData:[],currentData:[]}},created:function(){var e=this;this.query(""),m.a.$on("refreshUser",function(){e.query("")})},methods:{addEvent:function(){m.a.$emit("showAddUserForm")},query:function(e){var t=this;return i()(s.a.mark(function r(){var a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$http.get("/api/user/get",{params:{user_name:e}});case 3:200!==(a=r.sent).data.code?Object(p.a)(a.data):(t.tableData=a.data.data.reverse(),t.page()),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),Object(o.a)(r.t0);case 10:case"end":return r.stop()}},r,t,[[0,7]])}))()},handlePageChange:function(e){var t=e.currentPage,r=e.pageSize;this.tablePage.currentPage=t,this.tablePage.pageSize=r,this.currentData=this.tableData.slice((t-1)*r,r*t)},removeEvent:function(){var e=this,t=this.$refs.userTable.getCurrentRecord();return t?"admin"===t.user_id?Object(o.a)("不允许删除admin账号"):void this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(i()(s.a.mark(function r(){var a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,l.a.post("/api/user/delete",{},{params:{user_id:t.user_id}});case 3:200!==(a=r.sent).data.code?Object(p.a)(a.data):(e.tableData=a.data.data.reverse(),e.page()),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),Object(o.a)(r.t0.message);case 10:case"end":return r.stop()}},r,e,[[0,7]])}))).catch(function(){e.$message({type:"info",message:"已取消删除"})}):Object(o.a)("请先选择要删除的账号")},editEvent:function(){var e=this.$refs.userTable.getCurrentRecord();return e?"admin"===e.user_id?Object(o.a)("不允许在此处修改admin账号"):(this.user_data=e,void m.a.$emit("showEditUserForm")):Object(o.a)("请先选择需要修改的数据")},resetPwd:function(){var e=this,t=this.$refs.userTable.getCurrentRecord();if(!t)return Object(o.a)("请先选择需要重置密码的账号");this.$confirm("是否确定重置该账号密码?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(i()(s.a.mark(function r(){var a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$http.post("api/pwd/recover",{},{params:{user_id:t.user_id}});case 3:200!==(a=r.sent).data.code?Object(p.a)(a.data):e.$message.success("重置密码成功"),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),Object(o.a)(r.t0.message);case 10:case"end":return r.stop()}},r,e,[[0,7]])})))},page:function(){var e=this.tablePage.currentPage,t=this.tablePage.pageSize;this.currentData=this.tableData.slice((e-1)*t,t*e)}}},k={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("vxe-grid",{ref:"userTable",attrs:{border:"",resizable:"","toolbar-config":e.toolBarConfig,"row-config":{isCurrent:!0},columns:e.tableColumn,data:e.currentData},scopedSlots:e._u([{key:"toolbar_buttons",fn:function(){return[r("vxe-input",{attrs:{placeholder:"请输入用户名称",clearable:""},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}}),e._v(" "),r("vxe-button",{attrs:{status:"primary"},on:{click:function(t){return e.query(e.searchName)}}},[e._v("搜索")]),e._v(" "),r("vxe-button",{attrs:{status:"success"},on:{click:e.addEvent}},[e._v("新增")]),e._v(" "),r("vxe-button",{attrs:{status:"success"},on:{click:e.editEvent}},[e._v("修改")]),e._v(" "),r("vxe-button",{attrs:{status:"success"},on:{click:e.resetPwd}},[e._v("重置密码")]),e._v(" "),r("vxe-button",{attrs:{status:"success"},on:{click:e.removeEvent}},[e._v("删除")]),e._v(" "),r("vxe-button",{on:{click:function(t){return e.$refs.userTable.exportData()}}},[e._v("导出")])]},proxy:!0},{key:"pager",fn:function(){return[r("vxe-pager",{attrs:{layouts:["Sizes","PrevJump","PrevPage","Number","NextPage","NextJump","FullJump","Total"],"current-page":e.tablePage.currentPage,"page-size":e.tablePage.pageSize,total:e.tableData.length},on:{"update:currentPage":function(t){return e.$set(e.tablePage,"currentPage",t)},"update:current-page":function(t){return e.$set(e.tablePage,"currentPage",t)},"update:pageSize":function(t){return e.$set(e.tablePage,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tablePage,"pageSize",t)},"page-change":e.handlePageChange}})]},proxy:!0}])}),e._v(" "),r("user-add-form"),e._v(" "),r("user-edit-form",{attrs:{user_data:e.user_data}})],1)},staticRenderFns:[]};var $=r("VU/8")(x,k,!1,function(e){r("oj50")},"data-v-66ecabe2",null).exports,w={name:"userPage",components:{PageHead:r("Neex").a,UserList:$}},P={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("page-head",{staticClass:"nav"}),this._v(" "),t("el-container",[t("el-card",[t("user-list")],1)],1)],1)},staticRenderFns:[]};var y=r("VU/8")(w,P,!1,function(e){r("H0Np")},"data-v-31a4c8f0",null);t.default=y.exports},H0Np:function(e,t){},n3GN:function(e,t){},oj50:function(e,t){},sUJ6:function(e,t){}});
//# sourceMappingURL=6.4a1683cf503aedfcfcf8.js.map