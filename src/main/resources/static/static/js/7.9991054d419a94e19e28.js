webpackJsonp([7],{FnKR:function(e,t){},R5cd:function(e,t){},m7IL:function(e,t){},wt2j:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),o=a("exGp"),s=a.n(o),i=a("RwfU"),c=a("mtWM"),l=a.n(c),u=a("mvHQ"),d=a.n(u),f=a("g7ZD"),p=a("So6Q"),m=a("Er6Z"),v={name:"roleEditForm",created:function(){var e=this;f.a.$on("showEditForm",function(t){e.dialogVisible=!0,e.form=t,e.old=JSON.parse(d()(t))})},data:function(){return{old:{},form:{role_id:-1,role_name:"",role_description:""},dialogVisible:!1,formRule:{role_name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]}}},methods:{closeEvent:function(){this.dialogVisible=!1,this.$refs.form.resetFields()},save:function(){var e=this;return s()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate(function(){var t=s()(n.a.mark(function t(a){var r,o;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,r=void 0,-1!==e.form.role_id){t.next=10;break}return t.next=7,l.a.post("/api/role/add",e.form);case 7:r=t.sent,t.next=14;break;case 10:return o=Object(p.a)(e.old,e.form),t.next=13,l.a.post("/api/role/edit",o);case 13:r=t.sent;case 14:200!==r.data.code?Object(m.a)(r.data):(e.$message.success("操作成功"),f.a.$emit("refreshData",r.data.data.reverse()),e.closeEvent()),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(2),Object(i.a)(t.t0.message);case 20:case"end":return t.stop()}},t,e,[[2,17]])}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}},t,e)}))()}}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.dialogVisible,"before-close":e.closeEvent},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRule,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"role_name"}},[a("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.form.role_name,callback:function(t){e.$set(e.form,"role_name",t)},expression:"form.role_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色描述",prop:"role_description"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入角色描述"},model:{value:e.form.role_description,callback:function(t){e.$set(e.form,"role_description",t)},expression:"form.role_description"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeEvent}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var g={name:"roleList",components:{RoleEditForm:a("VU/8")(v,b,!1,function(e){a("m7IL")},"data-v-2baffaef",null).exports},data:function(){return{toolBarConfig:{slots:{buttons:"toolbar_buttons"}},searchName:"",tablePage:{currentPage:1,pageSize:10},tableColumn:[{field:"role_name",title:"角色名称",width:"200px"},{field:"role_description",title:"角色描述"}],tableData:[]}},created:function(){var e=this;this.query(""),f.a.$on("refreshData",function(t){e.tableData=t})},methods:{addEvent:function(){f.a.$emit("showEditForm",{role_id:-1,role_name:"",role_description:""})},query:function(e){var t=this;return s()(n.a.mark(function a(){var r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$http.get("/api/role/query",{params:{role_name:e}});case 3:200!==(r=a.sent).data.code?Object(m.a)(r.data):(t.tableData=r.data.data,t.page()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),Object(i.a)(a.t0);case 10:case"end":return a.stop()}},a,t,[[0,7]])}))()},handlePageChange:function(e){var t=e.currentPage,a=e.pageSize;this.tablePage.currentPage=t,this.tablePage.pageSize=a,this.currentData=this.tableData.slice((t-1)*a,a*t)},removeEvent:function(){var e=this,t=this.$refs.roleTable.getCurrentRecord();return t?"系统管理员"===t.role_name?Object(i.a)("系统管理员不可删除"):void this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(s()(n.a.mark(function a(){var r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,l.a.post("/api/role/delete",{role_id:t.role_id});case 3:200!==(r=a.sent).data.code?Object(m.a)(r.data):(e.$message.success("删除成功"),e.tableData=r.data.data,e.page()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),Object(i.a)(a.t0.message);case 10:case"end":return a.stop()}},a,e,[[0,7]])}))).catch(function(){e.$message({type:"info",message:"已取消删除"})}):Object(i.a)("请先选择要删除的角色")},editEvent:function(){var e=this.$refs.roleTable.getCurrentRecord();return e?"系统管理员"===e.role_name?Object(i.a)("系统管理员不可修改"):void f.a.$emit("showEditForm",e):Object(i.a)("请先选择需要修改的数据")},page:function(){var e=this.tablePage.pageSize;this.currentData=this.tableData.slice(0,e)}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("vxe-grid",{ref:"roleTable",attrs:{border:"",resizable:"","toolbar-config":e.toolBarConfig,"row-config":{isCurrent:!0},columns:e.tableColumn,data:e.tableData},scopedSlots:e._u([{key:"toolbar_buttons",fn:function(){return[a("vxe-input",{attrs:{placeholder:"请输入角色名称",clearable:""},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}}),e._v(" "),a("vxe-button",{attrs:{status:"primary"},on:{click:function(t){return e.query(e.searchName)}}},[e._v("搜索")]),e._v(" "),a("vxe-button",{attrs:{status:"success"},on:{click:e.addEvent}},[e._v("新增")]),e._v(" "),a("vxe-button",{attrs:{status:"success"},on:{click:e.editEvent}},[e._v("修改")]),e._v(" "),a("vxe-button",{attrs:{status:"success"},on:{click:e.removeEvent}},[e._v("删除")]),e._v(" "),a("vxe-button",{on:{click:function(t){return e.$refs.roleTable.exportData()}}},[e._v("导出")])]},proxy:!0},{key:"pager",fn:function(){return[a("vxe-pager",{attrs:{layouts:["Sizes","PrevJump","PrevPage","Number","NextPage","NextJump","FullJump","Total"],"current-page":e.tablePage.currentPage,"page-size":e.tablePage.pageSize,total:e.tableData.length},on:{"update:currentPage":function(t){return e.$set(e.tablePage,"currentPage",t)},"update:current-page":function(t){return e.$set(e.tablePage,"currentPage",t)},"update:pageSize":function(t){return e.$set(e.tablePage,"pageSize",t)},"update:page-size":function(t){return e.$set(e.tablePage,"pageSize",t)},"page-change":e.handlePageChange}})]},proxy:!0}])}),e._v(" "),a("role-edit-form",{staticStyle:{width:"80%",margin:"auto"}})],1)},staticRenderFns:[]};var _=a("VU/8")(g,h,!1,function(e){a("FnKR")},"data-v-cf42ae1c",null).exports,x={name:"rolePage",components:{PageHead:a("Neex").a,RoleList:_}},P={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("page-head",{staticClass:"nav"}),this._v(" "),t("el-container",[t("el-card",[t("role-list")],1)],1)],1)},staticRenderFns:[]};var k=a("VU/8")(x,P,!1,function(e){a("R5cd")},"data-v-672951dc",null);t.default=k.exports}});
//# sourceMappingURL=7.9991054d419a94e19e28.js.map